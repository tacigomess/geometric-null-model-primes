# Geometric Null Models for Prime Distributions

This repository accompanies the manuscript:

**Residual Spatial Correlations in Geometric Embeddings of Prime Numbers**  
Manuscript in preparation (2026)

---

## Overview

This project investigates the spatial organization of prime numbers through a continuous geometric embedding of the natural numbers into a logarithmic spiral. Within this geometric representation, we define local prime densities based on Euclidean neighborhoods and analyze their statistical properties across multiple spatial scales.

To assess whether observed local structures can be explained solely by geometric effects and by the average rarefaction of primes, we introduce a **geometric null model inspired by Cramér’s probabilistic model**. In this null configuration, the embedding geometry and global intensity are preserved, while arithmetic correlations are removed via independent Bernoulli sampling.

Comparisons between the real prime distribution and the null model are performed using non-parametric statistical tests, revealing residual spatial correlations at mesoscopic scales.

---

## Scientific goals

- Embed natural numbers and primes in a continuous geometric space
- Define and measure local prime density using spatial neighborhoods
- Construct a calibrated geometric null model of Cramér type
- Compare real and null configurations using distribution-level statistics
- Identify scale-dependent residual spatial correlations

---

## Repository structure

```
geometric-null-model-primes/
│
├── README.md
├── LICENSE
├── CITATION.cff
│
├── data/
│   ├── real_embedding.csv
│   ├── null_on_real_embedding.csv
│   └── radius_sweep_real_embedding.csv
│
├── scripts/
│   ├── generate_embedding.py
│   ├── generate_null_on_real_embedding.py
│   ├── compare_density_on_sampled_points_realembed.py
│   ├── sweep_radius_density_real_embedding.py
│   └── utils/
│       ├── primality.py
│       ├── geometry.py
│       └── sampling.py
│
├── figures/
│   ├── fig_real_vs_null_embedding_side_by_side.png
│   ├── fig_cdf_real_vs_null_R10.png
│   ├── fig_cdf_real_vs_null_R10_KS_zoom.png
│   ├── fig_ks_vs_radius_real_embedding.png
│   └── KS_vs_N_caps.png
│
├── paper/
│   ├── manuscript.docx
│   ├── manuscript.pdf
│   └── figures/
│
├── notebooks/
│   └── exploratory_analysis.ipynb
│
└── requirements.txt
```

---

## Installation

Clone the repository and install dependencies:

```bash
git clone https://github.com/SEU_USUARIO/geometric-null-model-primes.git
cd geometric-null-model-primes
pip install -r requirements.txt
```

Python ≥ 3.9 is recommended.

---

## Reproducing the results

### 1. Generate the geometric embedding

```bash
python scripts/generate_embedding.py
```

This script:
- embeds natural numbers in a logarithmic spiral,
- labels prime numbers,
- saves the result to `data/real_embedding.csv`.

---

### 2. Generate the geometric null model

```bash
python scripts/generate_null_on_real_embedding.py
```

This script:
- keeps the geometric embedding fixed,
- replaces prime labels with independent Bernoulli events,
- calibrates the normalization constant \( c \),
- saves the null realization to `data/null_on_real_embedding.csv`.

---

### 3. Compare local densities (reference scale)

```bash
python scripts/compare_density_on_sampled_points_realembed.py
```

This script:
- samples spatial centers from the full embedding,
- computes local densities for real and null configurations,
- performs Kolmogorov–Smirnov tests,
- generates CDF figures used in the manuscript.

---

### 4. Multi-scale robustness analysis

```bash
python scripts/sweep_radius_density_real_embedding.py
```

This script:
- repeats the density comparison across multiple radii,
- computes KS statistics as a function of scale,
- saves results to `data/radius_sweep_real_embedding.csv`,
- generates the KS × R figure.

---

## Figures

All figures appearing in the manuscript are generated by scripts in `scripts/` and saved in `figures/`:

- **Figure 1** — Geometric embedding and neighborhood illustration  
- **Figure 2** — Real vs null configuration (same geometry, side by side)  
- **Figure 3** — CDF of local densities at \( R = 10 \)  
- **Figure 3b** — Zoomed CDF with KS statistic highlighted  
- **Figure 4** — KS statistic as a function of neighborhood radius  
- **Supplementary** — KS vs cutoff experiments

---

## Methodological notes

- Local densities are **not evaluated exclusively at prime locations**, in order to avoid autoconditioning bias.
- All comparisons preserve:
  - embedding geometry,
  - global event intensity,
  - large-scale rarefaction.
- Statistical comparisons are performed on full empirical distributions, not only on mean values.

---

## Citation

If you use this code or build upon this work, please cite the accompanying manuscript.  
A `CITATION.cff` file is provided for automatic citation tools.

---

## License

This project is released under an open-source license (see `LICENSE`).

---

## Contact

**Taciana Gomes**  
Independent researcher  
GitHub: https://github.com/tacigomess
